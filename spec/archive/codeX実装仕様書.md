CodeX実装仕様書：計算スプリント UI体感改善 v0.2
0. 目的

60秒の制限時間内で、プレイヤーが

進んでいる（進捗）

速くなっている（速度体感）

没入できる（背景の継ぎ目排除）
を視覚的に理解できるUIにする。

1. 対象範囲（必須）

背景スクロールの継ぎ目を目立たなくする（可能ならシームレスループ）

速度に応じてランナーの位置・演出を変化させる

60秒の進捗が一目で分かる「距離/進捗バー」を追加する

2. 非対象（やらない）

新規画像素材の制作、既存背景画像の編集・修復

ゴール素材（ゲート/旗/町）など新規アート追加

効果音/BGM追加

3. 期待する見た目・挙動（受け入れ条件）
3.1 背景

背景が横方向にスクロールする際、明確な縦の継ぎ目が見えない（または目立たない）

速度が上がると背景の流れが明確に速くなる

可能ならパララックス（雲 < 遠景 < 地面 の順に速い）

3.2 ランナー（速度体感）

ランナーのX位置は固定ではなく、速度に応じて前後する

低速：画面左端寄り（例：5〜10%）

高速：画面中央寄り（例：25〜35%）

位置変化は滑らか（lerp or ease）

正解時に「加速した感」が1秒以内で分かる軽演出（例：スピードラインor風）

3.3 進捗バー

画面上部のHUDに「スタート→ゴール」形式の進捗バーを追加

進捗は (経過時間/60秒) を基本に、距離があるなら 距離優先

ランナーアイコンがバー上を移動

残り10秒でバーが強調（太く/光る/アニメ）※派手すぎない

4. 実装方針（推奨）
4.1 背景ループ（Canvas想定）

bgX を進め、bgX が画像幅を超えたら bgX -= width でループ

画像を2回描画して隙間を防ぐ
drawImage(bg, -bgX, 0) と drawImage(bg, -bgX + width, 0)

パララックスの場合：レイヤーごとに speedFactor を持つ

4.2 ランナーX位置

runnerXTarget = map(speed, minSpeed..maxSpeed, xMin..xMax)

runnerX += (runnerXTarget - runnerX) * 0.1 のような補間

正解時に boostTimer=0.4s を立て、演出表示（CSSクラスor描画）

4.3 進捗バー

DOMで追加（HUD内）

progress = clamp(elapsed/total, 0..1)

runnerMarker.style.left = (progress*100)+'%'

10秒切ったら hud.classList.add('final-phase')

5. 探索すべきファイル（CodeXがrepo内検索して特定）

ゲームループ / update / render：src/screens/gameScreen.* もしくは game.js main.js

背景描画：background.* renderer.* canvas.*

HUD：hud.* ui.* overlay.*

CSS：styles/style.css など

6. 変更内容（タスク分解）

HUDに進捗バーDOM追加（HTML or JS生成）

進捗計算（elapsed/60）とマーカー移動

ランナーXを速度に追従させる（固定廃止）

boost演出（正解時/連続正解時）を最小実装

背景の2枚ループ描画（継ぎ目対策）

可能ならパララックス導入（雲/遠景/地面、素材が無ければ単一背景のままでOK）

7. PR/パッチの提出形式

差分パッチ（git diff）で提出

変更ファイル一覧を冒頭に書く

追加した設定値（xMin/xMax, speedFactor等）をコメントで明示