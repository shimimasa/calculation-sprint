# Dash Run Variant 仕様レビュー資料

本資料は **Dash Run Variant** について、

* SSoT（`spec/product-spec.md`, `spec/tech-spec.md`）
* 追加仕様 Delta（`spec/new-produxt-spec.md`）
* 実装計画（`spec/plan/plan-dash-run-variant.md`）
* 現在までの実装差分

を突き合わせ、**現状の実装到達点・未実装項目・次ステップ**を明確にすることを目的とする。

---

## 1. 現在の到達点サマリ（結論）

* Dash Run Variant は **MVPとして成立する状態** に到達している
* 計算 × 自動ラン × 追跡 × 時間制 のコア体験は実装済み
* 教育現場向け制約（非派手・非競争・低刺激）は概ね遵守
* 未実装項目は **意図的延期（計画どおり）** のものが大半

👉 明日以降は「機能追加」ではなく、
**理解しやすさ・安全性・復元性を高める軽量PR** が最適

---

## 2. 実装カバレッジ一覧（仕様 × 実装）

### 2.1 ゲーム進行・ロジック

| 仕様項目                      | 状態  | 補足                       |
| ------------------------- | --- | ------------------------ |
| 自動ラン（rAFループ）              | 実装済 | 距離が毎フレーム更新               |
| 数学問題（1問ずつ）                | 実装済 | 既存 questionGenerator を流用 |
| 正解 → 速度UP / 時間UP          | 実装済 | 数値は暫定                    |
| 不正解 → 時間DOWN / streakリセット | 実装済 | 追加ペナルティなし                |
| 敵の追跡（速度差）                 | 実装済 | enemyGap による数値処理         |
| streakで敵速度UP              | 実装済 | 定数制御・調整延期                |
| 接触 → 大幅減少＋即終了             | 実装済 | ルール確定済                   |

---

### 2.2 コンボ・イベント

| 仕様項目         | 状態   | 補足             |
| ------------ | ---- | -------------- |
| streak（連続正解） | 実装済  | maxStreak 記録あり |
| 3連続攻撃        | 部分実装 | 数値処理のみ、演出なし    |
| 5連続撃破        | 部分実装 | 時間ボーナスのみ       |

※ 演出・SE・距離ボーナスは **計画上延期**

---

### 2.3 スコア・結果画面

| 項目         | 状態  | 補足          |
| ---------- | --- | ----------- |
| 距離（メインスコア） | 実装済 | m単位表示       |
| 正解数 / 不正解数 | 実装済 | 0除算安全       |
| 残り時間       | 実装済 | 秒表示         |
| 最大streak   | 実装済 | セッション保存     |
| ミス率        | 実装済 | Delta仕様を満たす |

---

### 2.4 保存・復元

| 項目         | 状態  | 補足                |
| ---------- | --- | ----------------- |
| profile別保存 | 実装済 | `dash.session.v1` |
| 結果画面表示     | 実装済 | リロード耐性は未強化        |

---

### 2.5 UI・UX

| 項目                | 状態  | 補足        |
| ----------------- | --- | --------- |
| 非白背景 / scoped CSS | 実装済 | 教室向け      |
| HUD（距離・時間・追跡）     | 実装済 | 数値中心      |
| 攻撃/撃破フィードバック      | 未実装 | テキストのみなら可 |
| 残り時間警告            | 未実装 | 軽量対応可能    |

---

## 3. 明示的に延期されている項目（SSoT準拠）

以下は **やらないことが正しい** 領域：

* 数値チューニング（速度・時間・ペナルティ）
* 新規ビジュアルアセット（敵・背景・演出）
* 新規オーディオアセット（BGM・警告SE）
* ランキング / リーダーボード
* レベル・称号・実績系表現

👉 いずれも **教育的リスク or 調整負荷が高い** ため、人手判断が必要

---

## 4. 次ステップ開発計画（安全・最小）

### PR候補①：攻撃・撃破のテキストフィードバック

**目的**

* 3連続 / 5連続の意味を子どもに伝える

**内容**

* HUDに短時間テキスト表示（例：

  * 3連続：「おした！」
  * 5連続：「はなれた！」）
* 新規アセットなし

---

### PR候補②：結果画面の復元性向上

**目的**

* リロード・再訪時に直前結果を表示

**内容**

* `gameState.dash.result` が無い場合

  * `dash.session.v1` を読む

---

### PR候補③：残り時間が少ないときの警告表示

**目的**

* 終了間際の状況を理解しやすく

**内容**

* HUD色 or テキスト変化のみ
* 教室向けに控えめ

---

## 5. 開発判断が必要な論点（今は触らない）

* 適切な1プレイ時間（3分？5分？）
* 接触ペナルティの厳しさ
* streak体験のストレス度
* 視覚演出の必要性

👉 **教室実測 → 判断** が必須

---

## 6. 明日以降の使い方

* 本mdを Cursor / CodeX に読み込ませる
* 次PRを「この資料の PR候補①〜③ に限定」して進める
* 数値・演出の議論は **実測後まで保留**

---

## 付記

本資料は

* 実装を否定せず
* 未実装を欠陥扱いせず
* 教育現場の制約を前提に

**安心して次に進むための整理資料** として作成している。
