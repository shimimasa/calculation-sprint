# ADR-009: UIイベントの一元化（click/touch/keyboardの重複・nullハンドラ防止・購読解除規約）

Status: Accepted
Date: 2026-02-07

## Context

- 画面ごとの `addEventListener` が増え、重複登録や購読解除漏れが起こり得る。
- DOM 参照が null の場合に例外が起きる余地がある。
- 大改修なしで、最小の共通ユーティリティで事故を抑止したい。

## Decision

1. **画面のイベント登録は `src/core/eventRegistry.js` に集約**する。
   - `createEventRegistry(screenName)` を使い、登録は 1 箇所で行う。
2. **重複登録はユーティリティ内で抑止**する。
   - 同一 target/type/handler は再登録しない。
3. **null ターゲット/ハンドラは警告のみでスキップ**する。
4. **画面遷移時に `events.clear()` を必ず呼び、購読解除を統一**する。

## Non-goals

- UIイベント体系の再設計（pointer/touch の統合は別途）。
- 画面構成の大規模リファクタ。

## Consequences

- 得るもの: 画面遷移時のイベント漏れ・二重登録が減る。
- 失うもの: ユーティリティ導入の分だけ初期コードが増える。

## References

- spec/adr/ADR-003.md
- spec/adr/ADR-006.md
- spec/tech-spec.md
- spec/test-results/adr-acceptance-latest.md
