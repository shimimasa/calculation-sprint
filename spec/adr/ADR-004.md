# ADR-004: ポータル統合（サブパス）を正とし、CSSスコープとアセット解決を統一ルール化するStatus: AcceptedDate: 2026-02-04Source of Truth: spec/adr/adr.md## Context- 統合直前の典型事故は「絶対パスで404」「CSS衝突で崩壊」。- 単体配布前提の作りは、サブパス/埋め込みで高確率に破綻する。- 長期運用では“他プロダクトと共存できること”が最重要。## Decision- 配布の正は「サブパス配信」を前提とする（単体直下は副次）。- アセット参照は相対パス/ベースパス可変を原則とし、絶対パス前提を禁止する。- CSSはアプリルート配下にスコープし、グローバルリセットの増築を禁止する。- storageキーはポータル共通の名前空間ルールに従い、衝突を防ぐ。## Non-goals- ビルドツール導入（Vite等）を前提にしない。- デザインシステム統一（全プロダクト同一UI）までは目指さない。- iframe前提の隔離運用に依存しない（使えても“正”にはしない）。## Consequences- 得るもの: 統合耐性、他画面への副作用抑制、長期運用の安全性。- 失うもの: 実装の自由度（安易な絶対パス/全体CSS）が減る＝規約遵守が必須。## Terminology- サブパス: 例 `/portal/games/calc-sprint/` 配下で動く配信形態。- CSSスコープ: アプリ外のDOM/CSSへ影響を漏らさない制約。## References- spec/adr/adr.md (ADR-004)
